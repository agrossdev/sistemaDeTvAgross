<!DOCTYPE html>
<html lang="pt-BR">


<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="gerarimagem.css">
    <script src="gerarimagem.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"
        integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="html2canvas.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="imagens/Logo - Grande Rodada do Realizador 02.png">
    <title>Gerar Imagem GRR</title>
</head>

<body>
    <div id="divbackground">
        <div id="divlogos">
            <img src="imagens/Logo - Grande Rodada do Realizador 02.png" alt="" id="imagemgrr"
                onclick="recarregarimagens();">
            <img src="imagens/agross.png" alt="" onclick="recarregarimagens();">
            <img src="imagens/tvagross.png" alt="" onclick="recarregarimagens();">
        </div>
        <div id="divformulario">
            <div id="divnome">
                <label for="inputnome">Ganhador:</label>
                <input type="text" id="inputnome" maxlength="-1">
            </div>
            <div id="divunidade">
                <label for="">Unidade:</label>
                <select name="unidade" id="unidade">
                    <option value="CAMPINAS/SP">CAMPINAS/SP</option>
                    <option value="ANÁPOLIS/GO">ANÁPOLIS/GO</option>
                    <option value="CARIACICA/ES">CARIACICA/ES</option>
                    <option value="CARAZINHO/RS">CARAZINHO/RS</option>
                    <option value="PETROLINA/PE">PETROLINA/PE</option>
                    <option value="RECIFE/PE">RECIFE/PE</option>
                    <option value="SETE LAGOAS/MG">SETE LAGOAS/MG</option>
                    <option value="LINS/SP">LINS/SP</option>
                    <option value="POUSO ALEGRE/MG">POUSO ALEGRE/MG</option>
                </select>
            </div>
            <div id="divpremio">
                <label for="">Premio:</label>
                <select name="premio" id="premio" onchange="mudarimagem(premio);">
                    <option value="primeiropremio">PRIMEIRO</option>
                    <option value="segundopremio">SEGUNDO</option>
                    <option value="bolamaior">BOLA MAIOR</option>
                </select>
            </div>
            <div id="divbolamaior" style="display: none;">
                <label for="qtdbolamaior">QTD</label>
                <select name="qtdbolamaior" id="qtdbolamaior" onchange="adicionarbolamaior(qtdbolamaior.value);">
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>

                </select>
            </div>
            <button type="button" id="btnenviar"
                onclick="mudarnome(inputnome, unidade, premio, qtdbolamaior.value);">GERAR IMAGEM</button>

        </div>
        <div id="divformulariobm" style="display: none;">
            <div class="divsbm" id="divbm2" style="display: none;">
                <div id="divnome2" style="display: flex; flex-direction: column;">
                    <label for="inputnome2">Ganhador 2:</label>
                    <input type="text" id="inputnome2" maxlength="50">
                </div>
                <div id="divunidade2" style="display: flex; flex-direction: column; margin-left: 15px;">
                    <label for="">Unidade 2:</label>
                    <select name="unidade2" id="unidade2">
                        <option value="CAMPINAS/SP">CAMPINAS/SP</option>
                        <option value="ANÁPOLIS/GO">ANÁPOLIS/GO</option>
                        <option value="CARIACICA/ES">CARIACICA/ES</option>
                        <option value="CARAZINHO/RS">CARAZINHO/RS</option>
                        <option value="PETROLINA/PE">PETROLINA/PE</option>
                        <option value="RECIFE/PE">RECIFE/PE</option>
                        <option value="SETE LAGOAS/MG">SETE LAGOAS/MG</option>
                        <option value="LINS/SP">LINS/SP</option>
                        <option value="POUSO ALEGRE/MG">POUSO ALEGRE/MG</option>
                    </select>
                </div>
            </div>
            <div class="divsbm" id="divbm3" style="display: none;">
                <div id="divnome3" style="display: flex; flex-direction: column;">
                    <label for="inputnome3">Ganhador 3:</label>
                    <input type="text" id="inputnome3" maxlength="50">
                </div>
                <div id="divunidade3" style="display: flex; flex-direction: column; margin-left: 15px;">
                    <label for="">Unidade 3:</label>
                    <select name="unidade3" id="unidade3">
                        <option value="CAMPINAS/SP">CAMPINAS/SP</option>
                        <option value="ANÁPOLIS/GO">ANÁPOLIS/GO</option>
                        <option value="CARIACICA/ES">CARIACICA/ES</option>
                        <option value="CARAZINHO/RS">CARAZINHO/RS</option>
                        <option value="PETROLINA/PE">PETROLINA/PE</option>
                        <option value="RECIFE/PE">RECIFE/PE</option>
                        <option value="SETE LAGOAS/MG">SETE LAGOAS/MG</option>
                        <option value="LINS/SP">LINS/SP</option>
                        <option value="POUSO ALEGRE/MG">POUSO ALEGRE/MG</option>
                    </select>
                </div>
            </div>
            <div class="divsbm" id="divbm4" style="display: none;">
                <div id="divnome4" style="display: flex; flex-direction: column;">
                    <label for="inputnome4">Ganhador 4:</label>
                    <input type="text" id="inputnome4" maxlength="50">
                </div>
                <div id="divunidade4" style="display: flex; flex-direction: column; margin-left: 15px;">
                    <label for="">Unidade 4:</label>
                    <select name="unidade4" id="unidade4">
                        <option value="CAMPINAS/SP">CAMPINAS/SP</option>
                        <option value="ANÁPOLIS/GO">ANÁPOLIS/GO</option>
                        <option value="CARIACICA/ES">CARIACICA/ES</option>
                        <option value="CARAZINHO/RS">CARAZINHO/RS</option>
                        <option value="PETROLINA/PE">PETROLINA/PE</option>
                        <option value="RECIFE/PE">RECIFE/PE</option>
                        <option value="SETE LAGOAS/MG">SETE LAGOAS/MG</option>
                        <option value="LINS/SP">LINS/SP</option>
                        <option value="POUSO ALEGRE/MG">POUSO ALEGRE/MG</option>
                    </select>
                </div>
            </div>
            <div class="divsbm" id="divbm5" style="display: none;">
                <div id="divnome5" style="display: flex; flex-direction: column;">
                    <label for="inputnome5">Ganhador 5:</label>
                    <input type="text" id="inputnome5" maxlength="50">
                </div>
                <div id="divunidade5" style="display: flex; flex-direction: column; margin-left: 15px;">
                    <label for="">Unidade 5:</label>
                    <select name="unidade5" id="unidade5">
                        <option value="CAMPINAS/SP">CAMPINAS/SP</option>
                        <option value="ANÁPOLIS/GO">ANÁPOLIS/GO</option>
                        <option value="CARIACICA/ES">CARIACICA/ES</option>
                        <option value="CARAZINHO/RS">CARAZINHO/RS</option>
                        <option value="PETROLINA/PE">PETROLINA/PE</option>
                        <option value="RECIFE/PE">RECIFE/PE</option>
                        <option value="SETE LAGOAS/MG">SETE LAGOAS/MG</option>
                        <option value="LINS/SP">LINS/SP</option>
                        <option value="POUSO ALEGRE/MG">POUSO ALEGRE/MG</option>
                    </select>
                </div>
            </div>
            <div class="divsbm" id="divbm6" style="display: none;">
                <div id="divnome6" style="display: flex; flex-direction: column;">
                    <label for="inputnome6">Ganhador 6:</label>
                    <input type="text" id="inputnome6" maxlength="50">
                </div>
                <div id="divunidade6" style="display: flex; flex-direction: column; margin-left: 15px;">
                    <label for="">Unidade 6:</label>
                    <select name="unidade6" id="unidade6">
                        <option value="CAMPINAS/SP">CAMPINAS/SP</option>
                        <option value="ANÁPOLIS/GO">ANÁPOLIS/GO</option>
                        <option value="CARIACICA/ES">CARIACICA/ES</option>
                        <option value="CARAZINHO/RS">CARAZINHO/RS</option>
                        <option value="PETROLINA/PE">PETROLINA/PE</option>
                        <option value="RECIFE/PE">RECIFE/PE</option>
                        <option value="SETE LAGOAS/MG">SETE LAGOAS/MG</option>
                        <option value="LINS/SP">LINS/SP</option>
                        <option value="POUSO ALEGRE/MG">POUSO ALEGRE/MG</option>
                    </select>
                </div>
            </div>




        </div>

        <div id="divimagem">
            <div id="divganhador">
                <p id="nomeganhador">NOME</p>
                <p id="nomeunidade">UNIDADE</p>

            </div>
            <div id="divsbatidas">
                <div id="1batida" style="display: none;">
                    <fieldset>
                        <legend>1ª Batida</legend>
                        <div id="div1batida" class="divbatidanumeros">
                            <p id="bmnome1" class="bmnomeclass">NOME</p>
                            <p class="bmunidade" id="bmunidade1">UNIDADE: </p>
                        </div>
                    </fieldset>
                </div>
                <div id="2batida" style="display: none;">
                    <fieldset>
                        <legend>2ª Batida</legend>
                        <div id="div2batida" class="divbatidanumeros">
                            <p id="bmnome2" class="bmnomeclass">NOME</p>
                            <p class="bmunidade" id="bmunidade2">UNIDADE: </p>
                        </div>
                    </fieldset>
                </div>
                <div id="3batida" style="display: none;">
                    <fieldset>
                        <legend>3ª Batida</legend>
                        <div id="div3batida" class="divbatidanumeros">
                            <p id="bmnome3" class="bmnomeclass">NOME</p>
                            <p class="bmunidade" id="bmunidade3">UNIDADE: </p>
                        </div>
                    </fieldset>
                </div>
                <div id="4batida" style="display: none;">
                    <fieldset>
                        <legend>4ª Batida</legend>
                        <div id="div4batida" class="divbatidanumeros">
                            <p id="bmnome4" class="bmnomeclass">NOME</p>
                            <p class="bmunidade" id="bmunidade4">UNIDADE: </p>
                        </div>
                    </fieldset>
                </div>
                <div id="5batida" style="display: none;">
                    <fieldset>
                        <legend>5ª Batida</legend>
                        <div id="div5batida" class="divbatidanumeros">
                            <p id="bmnome5" class="bmnomeclass">NOME</p>
                            <p class="bmunidade" id="bmunidade5">UNIDADE: </p>
                        </div>
                    </fieldset>
                </div>
                <div id="6batida" style="display: none;">
                    <fieldset>
                        <legend>6ª Batida</legend>
                        <div id="div6batida" class="divbatidanumeros">
                            <p id="bmnome6" class="bmnomeclass">NOME</p>
                            <p class="bmunidade" id="bmunidade6">UNIDADE: </p>
                        </div>
                    </fieldset>
                </div>


            </div>


        </div>
        <div id="previewImage"></div>

    </div>
    <div id="status">

    </div>
    <script>
        function screenshot(premio) {
            var premio = premio;

            html2canvas(document.getElementById('divimagem'), { allowTaint: true }).then(function (canvas) {

                //var preview = document.getElementById("previewImage");
                console.log(canvas);
                document.getElementById("previewImage").appendChild(canvas);

                var dataURL = canvas.toDataURL('image/png', 2.0);
                $.ajax({
                    type: "POST",
                    url: "http://10.19.3.84/grr/save-capture.php",
                    data: {
                        imgBase64: dataURL,
                        premio: premio
                    }
                }).done(function (o) {

                    console.log('saved');
                });
            });
            document.getElementById('divimagem').style.display = 'none';
        }

        $(function () {
            const socket = io()
            socket.nickname = ''

            socket.emit('login', socket.nickname)

            $('#inputnome').keyup(function (evt) {
                setTimeout(function () {
                    apagardigitando()
                }, 3000);

            })
            $('#inputnome').on('keypress paste', function (evt) {
                socket.emit('status', `Alguém está digitando...`)
            })

            function apagardigitando() {
                var testefunc = sessionStorage.getItem('funcao')
                var input1 = $('#inputnome').val()
                console.log(input1)
                if (testefunc === null){
                    sessionStorage.setItem('funcao', 's')
                    socket.emit('statusparado', '')
                    console.log('teste');
                    
                }else {
                    
                }
                
                
                
            }

        })

    </script>
</body>

</html>